<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather, Currency & News App</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .tabs { display: flex; justify-content: center; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; border-bottom: 2px solid transparent; }
        .tab.active { border-bottom: 2px solid #007BFF; font-weight: bold; }
        .content { display: none; }
        .content.active { display: block; }

        /* Weather Layout */
        .weather-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            width: 600px;
            margin: 0 auto;
            text-align: left;
        }

        .weather-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        .city-info { display: flex; align-items: center; }
        .city-flag { font-size: 24px; margin-right: 10px; }
        .city-name { font-weight: bold; font-size: 18px; }

        .weather-info { font-size: 16px; text-align: right; }
        .temp-current { font-weight: bold; color: #ff6600; }

        /* Currency Converter */
        .converter { margin-top: 20px; }
        .converter input, .converter select, .converter button { padding: 10px; margin: 5px; }

        /* News Section */
        .news-container { width: 600px; margin: 0 auto; text-align: left; }
        .news-item { padding: 10px; border-bottom: 1px solid #ddd; }
        .news-item a { text-decoration: none; color: #007BFF; font-weight: bold; }
    </style>
</head>
<body>

    <h1>Weather, Currency & News App</h1>
    
    <!-- Tabs -->
    <div class="tabs">
        <div class="tab active" onclick="switchTab('weather')">Weather</div>
        <div class="tab" onclick="switchTab('currency')">Currency Converter</div>
        <div class="tab" onclick="switchTab('news')">Latest News</div>
    </div>

    <!-- Weather Tab -->
    <div id="weather" class="content active">
        <div id="weather-list"></div>
    </div>

    <!-- Currency Converter Tab -->
    <div id="currency" class="content">
        <div class="converter">
            <label for="amount">Amount:</label>
            <input type="number" id="amount" placeholder="Enter amount">
            <select id="currency-type">
                <option value="CAD">CAD</option>
                <option value="USD">USD</option>
                <option value="AUD">AUD</option>
                <option value="NZD">NZD</option>
            </select>
            <button onclick="convertCurrency()">Convert</button>
        </div>
        <div id="conversion-result"></div>
    </div>

    <!-- News Tab -->
    <div id="news" class="content">
        <div class="news-container">
            <h2>Latest VNExpress News</h2>
            <div id="news-list">Loading news...</div>
        </div>
    </div>

    <script>
        const cities = [
            { name: "Nha Trang", country: "VN", flag: "ðŸ‡»ðŸ‡³" },
            { name: "Ho Chi Minh", country: "VN", flag: "ðŸ‡»ðŸ‡³" },
            { name: "Toronto", country: "CA", flag: "ðŸ‡¨ðŸ‡¦" },
            { name: "New York", country: "US", flag: "ðŸ‡ºðŸ‡¸" },
            { name: "San Diego", country: "US", flag: "ðŸ‡ºðŸ‡¸" },
            { name: "Auckland", country: "NZ", flag: "ðŸ‡³ðŸ‡¿" },
            { name: "Sydney", country: "AU", flag: "ðŸ‡¦ðŸ‡º" }
        ];

        const weatherAPIKey = '7a6fcb24abbfed747d57e54dbb9d1906';
        const currencyAPIKey = 'cbf6f683bd10c0457fe9f089';

        async function fetchWeather() {
            const weatherList = document.getElementById('weather-list');
            weatherList.innerHTML = ''; 

            for (let city of cities) {
                const url = `https://api.openweathermap.org/data/2.5/forecast?q=${city.name}&units=metric&appid=${weatherAPIKey}`;
                
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('City not found');
                    const data = await response.json();
                    
                    const currentTemp = data.list[0].main.temp;
                    const description = data.list[0].weather[0].description;
                    
                    const forecast = data.list.slice(8, 32, 8).map(f => `${f.main.temp}Â°C`).slice(0, 3).join(" | ");

                    const weatherItem = document.createElement('div');
                    weatherItem.className = 'weather-item';
                    weatherItem.innerHTML = `
                        <div class="city-info">
                            <span class="city-flag">${city.flag}</span> 
                            <span class="city-name">${city.name}</span>
                        </div>
                        <div class="weather-info">
                            <span class="temp-current">${currentTemp}Â°C</span>, ${description}<br>
                            <small>Next Days: ${forecast}</small>
                        </div>
                    `;
                    
                    weatherList.appendChild(weatherItem);
                    setTimeout(() => {
                        weatherItem.style.opacity = 1;
                        weatherItem.style.transform = 'translateY(0)';
                    }, 100);
                } catch (error) {
                    console.error('Weather fetch error:', error);
                }
            }
        }

        async function convertCurrency() {
            const amount = document.getElementById('amount').value;
            const currency = document.getElementById('currency-type').value;
            const url = `https://v6.exchangerate-api.com/v6/${currencyAPIKey}/latest/${currency}`;

            if (!amount) {
                document.getElementById('conversion-result').innerHTML = "Please enter an amount.";
                return;
            }

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Currency data not found');
                const data = await response.json();
                const rate = data.conversion_rates.VND;
                const converted = (amount * rate).toFixed(2);
                document.getElementById('conversion-result').innerHTML = `${amount} ${currency} = ${converted} VND`;
            } catch (error) {
                document.getElementById('conversion-result').innerHTML = "Error fetching exchange rates.";
            }
        }

        async function fetchNews() {
            const url = "https://api.allorigins.win/get?url=" + encodeURIComponent("https://vnexpress.net/rss/tin-moi-nhat.rss");

            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error("Error fetching news.");

                const data = await response.json(); // Convert to JSON
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(data.contents, "text/xml"); // Extract XML content

                // Extract news items
                const items = xmlDoc.querySelectorAll("item");
                let newsHtml = "";

                items.forEach((item, index) => {
                    if (index < 5) { // Limit to 5 news articles
                        const title = item.querySelector("title").textContent;
                        const link = item.querySelector("link").textContent;
                        newsHtml += `<p><a href="${link}" target="_blank">${title}</a></p>`;
                    }
                });

                document.getElementById("news").innerHTML = newsHtml;
            } catch (error) {
                document.getElementById("news").innerHTML = "Error fetching news.";
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.content').forEach(content => content.classList.remove('active'));
            document.querySelector(`.tab:nth-child(${tabName === 'weather' ? 1 : tabName === 'currency' ? 2 : 3})`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            if (tabName === 'news') fetchNews();
        }

        fetchWeather();
    </script>

</body>
</html>
